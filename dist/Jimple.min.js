!function(e,t){if("function"==typeof define&&define.amd)define(["module"],t);else if("undefined"!=typeof exports)t(module);else{var n={exports:{}};t(n),e.Jimple=n.exports}}(this,function(e){"use strict";function t(e,t){if(!e)throw new Error(t)}function n(e){return"[object Function]"===Object.prototype.toString.call(e)&&"Function"===e.constructor.name}function i(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function r(e,n){t(e.has(n),'Identifier "'+n+'" is not defined.')}function o(e,i){return t(n(i),"Service definition is not a Closure or invokable object"),e.add(i),i}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items={},this._instances=new Map,this._factories=new Set,this._protected=new Set,this._proxy=void 0,t=i(t)?t:{},Object.keys(t).forEach(function(e){this.set(e,t[e])},this)}return s(e,null,[{key:"provider",value:function(e){return{register:e}}}]),s(e,[{key:"get",value:function(e){r(this,e);var t=this._items[e],i=void 0;return n(t)?this._protected.has(t)?i=t:this._instances.has(t)?i=this._instances.get(t):(i=t(this._proxy?this._proxy:this),this._factories.has(t)||this._instances.set(t,i)):i=t,i}},{key:"set",value:function(e,t){this._items[e]=t}},{key:"has",value:function(e){return this._items.hasOwnProperty(e)}},{key:"factory",value:function(e){return o(this._factories,e)}},{key:"protect",value:function(e){return o(this._protected,e)}},{key:"keys",value:function(){return Object.keys(this._items)}},{key:"extend",value:function(e,i){r(this,e);var o=this._items[e];t(n(o)&&!1===this._protected.has(o),"Identifier '"+e+"' does not contain a service definition"),t(n(i),"The 'new' service definition for '"+e+"' is not a invokable object."),this._items[e]=function(e){return i(o(e),e)},this._factories.has(o)&&(this._factories.delete(o),this._factories.add(this._items[e]))}},{key:"register",value:function(e){e.register(this)}},{key:"raw",value:function(e){return r(this,e),this._items[e]}}],[{key:"proxy",value:function(e){t("undefined"!=typeof Proxy,"The actual environment does not support ES6 Proxy");var r=new this,o={},s=Object.getOwnPropertyNames(Object.getPrototypeOf(r)).filter(function(e){return n(r[e])});s.forEach(function(e){return o[e]=1});var u=new Proxy(o,{get:function(e,t){var n=s.includes(t)?r[t].bind(r):r.get(t);return"set"===t?function(t,i){return e[t]=1,n(t,i)}:n},set:function(e,n,i){return t(!s.includes(n),'The key "'+n+"\" isn't valid because it's the name of a method of the container"),e[n]=1,r.set(n,i),!0},ownKeys:function(e){return r.keys()},has:function(e,t){return r.has(t)},getOwnPropertyDescriptor:function(e,t){if(e[t]){var n=s.includes(t);return{configurable:!n,writable:!n,enumerable:!n,value:n?r[t]:r.get(t)}}}});return r._proxy=u,e=i(e)?e:{},Object.keys(e).forEach(function(t){u[t]=e[t]}),u}}]),e}();e.exports=u});