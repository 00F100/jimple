!function(t,e){if("function"==typeof define&&define.amd)define(["module"],e);else if("undefined"!=typeof exports)e(module);else{var n={exports:{}};e(n),t.Jimple=n.exports}}(this,function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new Error(e)}function i(t){return"[object Function]"===Object.prototype.toString.call(t)&&"Function"===t.constructor.name}function r(t){if("[object Object]"!==Object.prototype.toString.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function o(t,e){n(t.has(e),'Identifier "'+e+'" is not defined.')}function s(t,e){return n(i(e),"Service definition is not a Closure or invokable object"),t.add(e),e}var c=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=function(){function t(n){e(this,t),this._items={},this._instances=new Map,this._factories=new Set,this._protected=new Set,this._proxy=void 0,n=r(n)?n:{},Object.keys(n).forEach(function(t){this.set(t,n[t])},this)}return c(t,[{key:"get",value:function(t){o(this,t);var e=this._items[t],n=void 0;return i(e)?this._protected.has(e)?n=e:this._instances.has(e)?n=this._instances.get(e):(n=e(this._proxy?this._proxy:this),this._factories.has(e)||this._instances.set(e,n)):n=e,n}},{key:"set",value:function(t,e){this._items[t]=e}},{key:"has",value:function(t){return this._items.hasOwnProperty(t)}},{key:"factory",value:function(t){return s(this._factories,t)}},{key:"protect",value:function(t){return s(this._protected,t)}},{key:"keys",value:function(){return Object.keys(this._items)}},{key:"extend",value:function(t,e){o(this,t);var r=this._items[t];n(i(r)&&!1===this._protected.has(r),"Identifier '"+t+"' does not contain a service definition"),n(i(e),"The 'new' service definition for '"+t+"' is not a invokable object."),this._items[t]=function(t){return e(r(t),t)},this._factories.has(r)&&(this._factories.delete(r),this._factories.add(this._items[t]))}},{key:"register",value:function(t){t.register(this)}},{key:"raw",value:function(t){return o(this,t),this._items[t]}}],[{key:"proxy",value:function(t){n("undefined"!=typeof Proxy,"The actual environment does not support ES6 Proxy");var e=new this,o={},s=Object.getOwnPropertyNames(Object.getPrototypeOf(e)).filter(function(t){return i(e[t])});s.forEach(function(t){return o[t]=1});var c=new Proxy(o,{get:function(t,n){var i=s.indexOf(n)>-1?e[n].bind(e):e.get(n);return"set"===n?function(e,n){return t[e]=1,i(e,n)}:i},set:function(t,i,r){return n(-1===s.indexOf(i),'The key "'+i+"\" isn't valid because it's the name of a method of the container"),t[i]=1,e.set(i,r),!0},ownKeys:function(t){return e.keys()},has:function(t,n){return e.has(n)},getOwnPropertyDescriptor:function(t,n){if(t[n]){var i=s.indexOf(n)>-1;return{configurable:!i,writable:!i,enumerable:!i,value:i?e[n]:e.get(n)}}}});return e._proxy=c,t=r(t)?t:{},Object.keys(t).forEach(function(e){c[e]=t[e]}),c}}]),t}();t.exports=u});