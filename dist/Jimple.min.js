!function(t,e){if("function"==typeof define&&define.amd)define(["module"],e);else if("undefined"!=typeof exports)e(module);else{var n={exports:{}};e(n),t.Jimple=n.exports}}(this,function(t){"use strict";var e=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();function i(t,e){if(!t)throw new Error(e)}function r(t){return"[object Function]"===Object.prototype.toString.call(t)&&"Function"===t.constructor.name}function o(t,e){i(t.has(e),'Identifier "'+e+'" is not defined.')}function n(t,e){return i(r(e),"Service definition is not a Closure or invokable object"),t.add(e),e}var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._items={},this._instances=new Map,this._factories=new Set,this._protected=new Set,e=function(t){if("[object Object]"!==Object.prototype.toString.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}(e)?e:{},Object.keys(e).forEach(function(t){this.set(t,e[t])},this)}return e(t,null,[{key:"provider",value:function(t){return{register:t}}}]),e(t,[{key:"get",value:function(t){o(this,t);var e=this._items[t],n=void 0;return r(e)?this._protected.has(e)?n=e:this._instances.has(e)?n=this._instances.get(e):(n=e(this),this._factories.has(e)||this._instances.set(e,n)):n=e,n}},{key:"set",value:function(t,e){this._items[t]=e}},{key:"has",value:function(t){return this._items.hasOwnProperty(t)}},{key:"factory",value:function(t){return n(this._factories,t)}},{key:"protect",value:function(t){return n(this._protected,t)}},{key:"keys",value:function(){return Object.keys(this._items)}},{key:"extend",value:function(t,e){o(this,t);var n=this._items[t];i(r(n)&&!1===this._protected.has(n),"Identifier '"+t+"' does not contain a service definition"),i(r(e),"The 'new' service definition for '"+t+"' is not a invokable object."),this._items[t]=function(t){return e(n(t),t)},this._factories.has(n)&&(this._factories.delete(n),this._factories.add(this._items[t]))}},{key:"register",value:function(t){t.register(this)}},{key:"raw",value:function(t){return o(this,t),this._items[t]}}]),t}();t.exports=s});