!function(e,t){if("function"==typeof define&&define.amd)define(["module"],t);else if("undefined"!=typeof exports)t(module);else{var n={exports:{}};t(n),e.Jimple=n.exports}}(this,function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new Error(t)}function i(e){return"[object Function]"===Object.prototype.toString.call(e)&&"Function"===e.constructor.name}function r(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function o(e,t){n(e.has(t),'Identifier "'+t+'" is not defined.')}function s(e,t){return n(i(t),"Service definition is not a Closure or invokable object"),e.add(t),t}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(){function e(n){t(this,e),this._items={},this._instances=new Map,this._factories=new Set,this._protected=new Set,n=r(n)?n:{},Object.keys(n).forEach(function(e){this.set(e,n[e])},this)}return c(e,[{key:"get",value:function(e){o(this,e);var t=this._items[e],n=void 0;return i(t)?this._protected.has(t)?n=t:this._instances.has(t)?n=this._instances.get(t):(n=t(this),this._factories.has(t)||this._instances.set(t,n)):n=t,n}},{key:"set",value:function(e,t){this._items[e]=t}},{key:"has",value:function(e){return this._items.hasOwnProperty(e)}},{key:"factory",value:function(e){return s(this._factories,e)}},{key:"protect",value:function(e){return s(this._protected,e)}},{key:"keys",value:function(){return Object.keys(this._items)}},{key:"extend",value:function(e,t){o(this,e);var r=this._items[e];n(i(r)&&!1===this._protected.has(r),"Identifier '"+e+"' does not contain a service definition"),n(i(t),"The 'new' service definition for '"+e+"' is not a invokable object."),this._items[e]=function(e){return t(r(e),e)},this._factories.has(r)&&(this._factories.delete(r),this._factories.add(this._items[e]))}},{key:"register",value:function(e){e.register(this)}},{key:"raw",value:function(e){return o(this,e),this._items[e]}}],[{key:"proxy",value:function(e){n("undefined"!=typeof Proxy,"The actual environment does not support ES6 Proxy");var t=new this(e),i={},r=["set","get","raw","extend","protect","factory","keys","has","register"];return r.forEach(function(e){return i[e]=!0}),t.keys().forEach(function(e){return i[e]=!0}),new Proxy(i,{get:function(e,n){var i=r.includes(n)?t[n].bind(t):t.get(n);return"set"===n?function(t,n){return e[t]=!0,i(t,n)}:i},set:function(e,i,o){return n(!r.includes(i),'The key "'+i+"\" isn't valid because it's the name of a method of the container"),e[i]=!0,t.set(i,o),!0},ownKeys:function(e){return t.keys()},has:function(e,n){return t.has(n)},getOwnPropertyDescriptor:function(e,n){if(e[n])return{configurable:!t[n],writable:!t[n],enumerable:!t[n],value:t.has(n)?t.get(n):void 0}}})}}]),e}();e.exports=u});