!function(e,t){if("function"==typeof define&&define.amd)define(["module"],t);else if("undefined"!=typeof exports)t(module);else{var n={exports:{}};t(n),e.Jimple=n.exports}}(this,function(e){"use strict";var t=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function s(e,t){if(!e)throw new Error(t)}function u(e){return"[object Function]"===Object.prototype.toString.call(e)&&"Function"===e.constructor.name}function c(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function i(e,t){s(e.has(t),'Identifier "'+t+'" is not defined.')}function n(e,t){return s(u(t),"Service definition is not a Closure or invokable object"),e.add(t),t}var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items={},this._instances=new Map,this._factories=new Set,this._protected=new Set,this._proxy=void 0,t=c(t)?t:{},Object.keys(t).forEach(function(e){this.set(e,t[e])},this)}return t(e,null,[{key:"provider",value:function(e){return{register:e}}}]),t(e,[{key:"get",value:function(e){i(this,e);var t=this._items[e],n=void 0;return u(t)?this._protected.has(t)?n=t:this._instances.has(t)?n=this._instances.get(t):(n=t(this._proxy?this._proxy:this),this._factories.has(t)||this._instances.set(t,n)):n=t,n}},{key:"set",value:function(e,t){this._items[e]=t}},{key:"has",value:function(e){return this._items.hasOwnProperty(e)}},{key:"factory",value:function(e){return n(this._factories,e)}},{key:"protect",value:function(e){return n(this._protected,e)}},{key:"keys",value:function(){return Object.keys(this._items)}},{key:"extend",value:function(e,t){i(this,e);var n=this._items[e];s(u(n)&&!1===this._protected.has(n),"Identifier '"+e+"' does not contain a service definition"),s(u(t),"The 'new' service definition for '"+e+"' is not a invokable object."),this._items[e]=function(e){return t(n(e),e)},this._factories.has(n)&&(this._factories.delete(n),this._factories.add(this._items[e]))}},{key:"register",value:function(e){e.register(this)}},{key:"raw",value:function(e){return i(this,e),this._items[e]}}],[{key:"proxy",value:function(t){s("undefined"!=typeof Proxy,"The actual environment does not support ES6 Proxy");var r=new this,n={},o=Object.getOwnPropertyNames(Object.getPrototypeOf(r)).filter(function(e){return u(r[e])});o.forEach(function(e){return n[e]=1});var i=new Proxy(n,{get:function(n,e){var i=o.includes(e)?r[e].bind(r):r.get(e);return"set"===e?function(e,t){return n[e]=1,i(e,t)}:i},set:function(e,t,n){return s(!o.includes(t),'The key "'+t+"\" isn't valid because it's the name of a method of the container"),e[t]=1,r.set(t,n),!0},ownKeys:function(e){return r.keys()},has:function(e,t){return r.has(t)},getOwnPropertyDescriptor:function(e,t){if(e[t]){var n=o.includes(t);return{configurable:!n,writable:!n,enumerable:!n,value:n?r[t]:r.get(t)}}}});return r._proxy=i,t=c(t)?t:{},Object.keys(t).forEach(function(e){i[e]=t[e]}),i}}]),e}();e.exports=r});